# http概述

Web 浏览器、服务器和相关的 Web 应用程序都是通过 HTTP 相互通信

## 资源

源不一定非得是静态文件。资源还可以是根据需要生成内容的软件程序

### URI

每个 Web 服务器资源都有一个名字，这样客户端就可以说明它们感兴趣的资源是什么了。**服务器资源名被称为统一资源标识符（Uniform Resource Identi?er，URI）**。URI 就像因特网上的邮政地址一样，在世界范围内唯一标识并定位信息资源

### URL

**统一资源定位符（URL）**是资源标识符最常见的形式； 描述了一台特定服务器上某资源的特定位置；明确说明如何从一个精确、固定的位置获取资源

大部分 URL 都遵循一种标准格式，这种格式包含三个部分

1. 第一部分被称为方案（scheme），说明了访问资源所使用的协议类型。这部分通常就是 HTTP 协议（http://）
2. 第二部分给出了服务器的因特网地址（比如，[www.joes-hardware.com](http://www.joes-hardware.com)）
3. 其余部分指定了Web 服务器上的某个资源

### URN

**统一资源名（URN）**。URN 是作为特定内容的唯一名称使用的，**与目前的资源所在地无关。使用这些与位置无关的 URN，就可以将资源四处搬移。**通过 URN，还可以用同一个名字通过多种网络访问协议来访问资源

urn:ietf:rfc:2141

## 事务

一个 HTTP 事务由一条（从客户端发往服务器的）请求命令和一个（从服务器发回客户端的）响应结果组成

### 方法

- GET
- PUT
- DELETE
- POST
- HEAD

### 状态码

每条 HTTP 响应报文返回时都会携带一个状态码。**状态码是一个三位数字的代码，告知客户端请求是否成功，或者是否需要采取其他动作**

### Web页面中可以包含多个对象

应用程序完成一项任务时通常会发布多个 HTTP 事务。

## 报文

HTTP 报文是由一行一行的简单字符串组成的。HTTP 报文都是纯文本，不是二进制代码，所以人们可以很方便地对其进行读写

**从 Web 客户端发往 Web 服务器的 HTTP 报文称为请求报文（request message）**。**从服务器发往客户端的报文称为响应报文（response message）**

HTTP 报文包括以下三个部分

- 起始行

  报文的第一行就是起始行，**在请求报文中用来说明要做些什么，**在**响应报文中说明出现了什么情况**

- 首部字段

  起始行后面有零个或多个首部字段。**每个首部字段都包含一个名字和一个值，为了便于解析，两者之间用冒号（:）来分隔。**首部以一个空行结束。添加一个首部字段和添加新行一样简单

- 主体

  空行之后就是可选的报文主体了，其中包含了所有类型的数据。请求主体中包括了要发送给 Web 服务器的数据；响应主体中装载了要返回给客户端的数据。起始行和首部都是文本形式且都是结构化；

  体中可以包含任意的二进制数据（比如图片、视频、音轨、软件程序）。当然，主体中也可以包含文本

![image](https://github.com/NoahsDante/webNotes/blob/master/http/img/1.png)

## 连接

讨论一下报文是如何通过传输控制协议（Transmission Control Protocol，TCP）连接从一个地方搬移到另一个地方去

### TCP/IP

- 无差错的数据传输
- 按序传输（数据总是会按照发送的顺序到达）
- 未分段的数据流（可以在任意时刻以任意尺寸将数据发送出去）

TCP/IP 隐藏了各种网络和硬件的特点及弱点，使各种类型的计算机和网络都能够进行可靠地通信；只要建立了 TCP 连接，客户端和服务器之间的报文交换就不会丢失、不会被破坏，也不会在接收时出现错序了

![image](https://github.com/NoahsDante/webNotes/blob/master/http/img/2.png)

### 连接、IP地址及端口号

**在 HTTP 客户端向服务器发送报文之前，需要用网际协议（Internet Protocol，IP）地址和端口号在客户端和服务器之间建立一条 TCP/IP 连接**

![image](https://github.com/NoahsDante/webNotes/blob/master/http/img/3.png)

#### 步骤

1. 浏览器从 URL 中**解析出服务器的主机名**；
2. 浏览器将服务器的**主机名转换成服务器的 IP 地址**；
3. 浏览器将端口号（如果有的话）从 URL 中解析出来；
4. 浏览器**建立一条与 Web 服务器的 TCP 连接；**
5. 浏览器**向服务器发送一条 HTTP 请求报文；**
6. 服务器**向浏览器回送一条 HTTP 响应报文；**
7. **关闭连接，浏览器显示文档。**

## Web 的结构组件

### 代理

**代理位于客户端和服务器之间，接收所有客户端的 HTTP 请求，并将这些请求转发给服务器（可能会对请求进行修改之后转发）**

![image](https://github.com/NoahsDante/webNotes/blob/master/http/img/4.png)

### 缓存

Web 缓存（Web cache）或代理缓存（proxy cache）是一种特殊的 HTTP 代理服务器，**可以将经过代理传送的常用文档复制保存起来。下一个请求同一文档的客户端就可以享受缓存的私有副本所提供的服务**

![image](https://github.com/NoahsDante/webNotes/blob/master/http/img/5.png)

### 网关

网关（gateway）是一种特殊的服务器，**作为其他服务器的中间实体使用。通常用于将 HTTP 流量转换成其他的协议。网关接受请求时就好像自己是资源的源端服务器一样**。**客户端可能并不知道自己正在与一个网关进行通信**

### 隧道

隧道（tunnel）是建立起来之后，就会在两条连接之间对原始数据进行盲转发的 HTTP 应用程序。**HTTP 隧道通常用来在一条或多条 HTTP 连接上转发非 HTTP 数据，转发时不会窥探数据。**

HTTP 隧道的一种常见用途是**通过 HTTP 连接承载加密的安全套接字层（SSL， Secure Sockets Layer）流量，这样 SSL 流量就可以穿过只允许 Web 流量通过的防火墙**

![image](https://github.com/NoahsDante/webNotes/blob/master/http/img/6.png)

### Agent代理

用户 Agent 代理（或者简称为 Agent 代理）是代表用户发起 HTTP 请求的客户端程序。所有发布 Web 请求的应用程序都是 HTTP Agent 代理。到目前为止，我们只提到过一种 HTTP Agent 代理：Web 浏览器，但用户 Agent 代理还有很多其他类型。

比如，有些自己会在 Web 上闲逛的自动用户 Agent 代理，可以在无人监视的情况下发布 HTTP 事务并获取内容。这些自动代理的名字通常都很生动，比如“网络蜘蛛”（spiders）或者“Web 机器人”（Web robots）。网络蜘蛛会在 Web 上闲逛，搜集信息以构建有效的 Web 内容档案

![image](https://github.com/NoahsDante/webNotes/blob/master/http/img/7.png)

# URL与资源

就是**因特网资源的标准化名称**。URL 指向一条条电子信息片段，告诉你**它们位于何处，以及如何与之进行交互**

## 浏览因特网资源

URL 是浏览器寻找信息时所需的资源位置。通过 URL，人类和应用程序才能找到、使用并共享因特网上大量的数据资源

**URI 是一类更通用的资源标识符，** **URL 实际上是它的一个子集。URI 是一个通用的概念，**由两个主要的子集 URL 和 URN 构成，**URL 是通过描述资源的位置来标识资源**；**URN则是通过名字来识别资源的，与它们当前所处位置无**

### URL 分以下三部分

1. 第一部分被称为方案（scheme），**说明了访问资源所使用的协议类型。告知 Web 客户端怎样访问资源；**这部分通常就是 HTTP 协议（http://）
2. 第二部分给出了**服务器的因特网地址（比如，[www.joes-hardware.com](http://www.joes-hardware.com)）；服务器的位置**
3. 第三部分**资源路径。路径说明了请求的是服务器上哪个特定的本地资源**

![image](https://github.com/NoahsDante/webNotes/blob/master/http/img/8.png)

**URL可以通过HTTP之外的其他协议来访问资**

URL 提供了一种统一的资源命名方式。大多数 URL 都有同样的：**“方案 :// 服务器位置 / 路径”结构**

URL 为应用程序**提供了一种访问资源的手段；**

为**用户及他们的浏览器提供了找到信息所需的所有条件；**

定义了用户所需的特定资源，它位于何处以及如何获取它

## URL 的语法

### 方案——使用什么协议

方案实际上是规定如何访问指定资源的主要标识符，它会**告诉负责解析 URL 的应用程序应该使用什么协议；**方案组件必须以**一个字母符号开始，由第一个“:”符号将其与 URL 的其余部分分隔开来**。方案名是大小写无关

### 主机与端口

主机组件标识了因特网上能够访问资源的宿主机器。可以用上述主机名（[www.joeshardware.com](http://www.joeshardware.com)），或者 IP 地址来表示主机名

### 用户名和密码

FTP 服务器就是这样一个常见的实例

```
ftp://anonymous@ftp.prep.ai.mit.edu/pub/gnu
ftp://anonymous:my_passwd@ftp.prep.ai.mit.edu/pub/gnu
```

### 路径

路径组件说明了资源位于服务器的什么地方。路径通常很像一个分级的文件系统路径。

### 参数

为了向应用程序提供它们所需的输入参数，以便正确地与服务器进行交互。

这个组件就是 URL 中的名值对列表，由字符“;”将其与 URL 的其余部分（以及各名值对）分隔开来

```
ftp://prep.ai.mit.edu/pub/gnu;type=d
http://www.joes-hardware.com/hammers;sale=false/index.html;graphics=true
```

### 查询字符串

可以通过提问题或进行查询来缩小所请求资源类型范围。只有问号（?）右边的内容；URL 的查询组件和标识网关资源的 URL 路径组件一起被发送给网关资源；值对之间用字符“&”分隔

### 片段

除了资源级之外，还可以做进一步的划分；能够指定资源中的那些章节。URL 支持使用片段（frag）组件来表示一个资源内部的片段；最前面有一个字符“#”

## URL 快捷方式

相对 URL 是在某资源内部**指定一个资源的便捷缩略方式。**

很多浏览器还**支持 URL 的“自动扩展”，也就是用户输入 URL 的一个关键（可记忆的）部分，然后由浏览器将其余部分填充起来。**

### 相对URL

URL 有两种方：绝对的和相对。

### 自动扩展URL

有些浏览器会在用户提交 URL 之后，或者在用户输入的时候尝试着自动扩展 URL。这就为用户提供了一条捷径：用户不需要输入完整的 URL，因为浏览器会自动扩展。

## 各种字符

### URL字符集

通过转义序列，就可以用 US-ASCII 字符集的有限子集对任意字符值或数据进行编码

### 编码机制

用来在 URL 中表示各种不安全的字符

### 字符限制

在 URL 中，有几个字符被保留起来，有着特殊的含义。有些字符不在定义的US-ASCII 可打印字符集中。还有些字符会与某些因特网网关和协议产生混淆

保留及受限字符

% / . .. # ? ; : $ + @ & = {} | \ ^ ~ [] '' <> ""   0x00-0x1F, 0x7F  >0x7F 

## 方案的世界

http 、https、mailto、ftp、rtsp、rtspu、file、news、telnet、

# HTTP报文

